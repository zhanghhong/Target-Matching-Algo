# 根据距离、方位、俯仰、速度进行目标匹配

### 1. 使用说明(windows/cmake)

- 运行build_cmake.bat进行编译
- 编译后在Matching-Algo/build/match-raev.exe运行

### 2. 问题背景

假设系统内部已有若干个目标实时更新中，现在需要根据输入的距离、方位、俯仰、速度去匹配最接近的目标，然后获取对应的索引。

匹配方式主要根据 输入特征与目标特征间的差距，计算出一个综合隶属度。但是因为距离(m)、方位/俯仰(°)、速度(m/s)量纲不同，直接相加会导致量纲大的特征支配最终结果。

### 3. 当前方案

1. 首先进行速度初筛。
2. 让角度误差（°）在远处目标上，换算成的横向距离误差（米），与距离误差 σₙ 处于同一个数量级。换句话说，就是让角度变化在“空间上”的影响，与距离变化一样重要。

### 4. 实际步骤

1. 先定基准：

    距离基准 ( $\sigma_r$ )：当前使用 **500 m**（结合我的距离范围 100–300 km）。

2. 角度随距离自适应：
    让“ 1$\sigma$ 角度误差”在该距离 ($R$) 上产生的横向误差约等于 “$1 \sigma_r$”，即角度变化在“空间上”影响与距离变化一样重要。
    $$\sigma_{\text{ang,deg}}(R) \approx \frac{\sigma_r}{R}\cdot \frac{180}{\pi} $$
3. 计算标准化距离：
$$    d^2=\Big(\frac{\Delta r}{\sigma_r}\Big)^2+
    \Big(\frac{\Delta \text{az}_\circ}{\sigma_\text{az}}\Big)^2+
    \Big(\frac{\Delta \text{el}_\circ}{\sigma_\text{el}}\Big)^2+
    \Big(\frac{\Delta v}{\sigma_v}\Big)^2  $$
    其中针对方位使用最小环差（例如方位 359° 与 1° 的差是 2°，不是 358°）。

4. 把距离映射成隶属度：

$$\mu=\exp!\big(-\tfrac{1}{2}d^2\big)  $$
5. 取隶属度最大的索引：若通过门限，返回 $\mu$ 最大（等价于 $d^2$ 最小）的目标索引

### 5. 举例说明

- 若 $σ_r = 500 m，R = 200,000 m$ ，则：$σ_{\text{ang,deg}} = 500 / 200000 × 180/π ≈ 0.14°$

此时：

- 方位误差 ±0.14° 在 200 km 处约等于 200,000 × tan(0.14°) ≈ 489 m 横向误差。
- 与 σ_r=500 m 对应的前后误差量级几乎一致。
